<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma√Ætre du Jeu - Malakoff Quiz</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Panneau d'informations permanent (code partie + joueurs) -->
    <aside id="gameInfoPanel" class="game-info-panel" style="display: none;">
        <div class="panel-code-display">
            <h3>Code de la partie</h3>
            <div class="game-code-number" id="panelGameCode">----</div>
        </div>
        <div class="players-status-section">
            <h3>Joueurs <span class="player-counter">(<span id="panelPlayerCount">0</span>)</span></h3>
            <div id="panelPlayersList" class="players-status-list">
                <p class="empty-state">Aucun joueur</p>
            </div>
        </div>
    </aside>

    <div class="container">
        <!-- √âCRAN 1 : Configuration de la partie -->
        <div id="setupScreen" class="screen active">
            <h1>Configuration de la partie</h1>
            <p>S√©lectionnez les questions pour votre quiz</p>

            <!-- Ordre des manches -->
            <div id="mancheOrderControl" class="manche-order-container">
                <!-- Charg√© dynamiquement par displayMancheOrderControl() -->
            </div>

            <!-- Filtres par manche -->
            <div id="mancheFiltersHost" class="manche-filters-host">
                <!-- Charg√© dynamiquement -->
            </div>
            
            <div class="select-all-container">
                <input type="checkbox" id="selectAllCheckbox">
                <label for="selectAllCheckbox"><strong>Tout s√©lectionner</strong></label>
            </div>
            
            <div id="questionsSelection" class="questions-list">
                <!-- Charg√© dynamiquement via JS -->
            </div>

            <button id="createGameBtn" class="btn btn-primary">Cr√©er la partie</button>
            <button id="restoreGameBtn" class="btn btn-secondary" style="margin-top: 15px;">üîÑ Reprendre une partie</button>
        </div>

        <!-- √âCRAN 2 : Salle d'attente -->
        <div id="waitingScreen" class="screen">
            <div class="game-code-display">
                <h2>Code de la partie</h2>
                <div id="gameCode" class="code">----</div>
                <p>Communiquez ce code aux joueurs</p>
            </div>
            
            <div class="players-waiting">
                <h3>Joueurs connect√©s (<span id="playerCount">0</span>)</h3>
                <div id="playersList" class="players-list">
                    <p class="empty-state">En attente des joueurs...</p>
                </div>
            </div>
            
            <button id="startGameBtn" class="btn btn-primary" disabled>Lancer la partie</button>
        </div>

        <!-- √âCRAN 3 : Question en cours -->
        <div id="questionScreen" class="screen">
            <div class="game-header">
                <div class="game-info">
                    <span>Code: <strong id="currentGameCode">----</strong></span>
                    <span>Question <span id="questionNumber">1</span>/<span id="totalQuestions">10</span></span>
                    <span>‚è±Ô∏è <span id="timer">20</span>s</span>
                </div>
            </div>
            
            <!-- Affichage de la manche -->
            <div id="mancheDisplay" class="manche-display" style="display:none;">
                <span class="manche-icon">üéØ</span>
                <span class="manche-name">Manche: <strong id="mancheName">-</strong></span>
            </div>
            
            <div class="question-display">
                <h2 id="questionText">Question...</h2>
                
                <!-- Pour QCM -->
                <div id="qcmChoices" class="choices" style="display:none;">
                    <!-- Charg√© dynamiquement -->
                </div>
                
                <!-- Pour Vrai/Faux -->
                <div id="vraiFauxChoices" class="choices" style="display:none;">
                    <!-- Charg√© dynamiquement -->
                </div>
                
                <!-- R√©ponse correcte (visible uniquement pour le ma√Ætre) -->
                <div id="correctAnswer" class="correct-answer">
                    Bonne r√©ponse : <strong id="correctAnswerText">-</strong>
                </div>
            </div>
            
            <div class="responses-section">
                <h3>R√©ponses des joueurs (<span id="responsesCount">0</span>/<span id="totalPlayersCount">0</span>)</h3>
                <div id="responsesList" class="responses-list">
                    <!-- Charg√© dynamiquement -->
                </div>
            </div>
            
            <button id="revealResultsBtn" class="btn btn-success" style="display:none;">üé≠ R√©v√©ler les r√©sultats</button>
            <button id="showLeaderboardBtn" class="btn btn-primary" style="display:none; margin-top: 10px;">üìä Afficher le classement</button>
            <button id="endGameBtnQuestion" class="btn btn-danger" style="margin-top: 10px;">‚èπÔ∏è Terminer la partie</button>
        </div>

        <!-- √âCRAN 4 : Classement -->
        <div id="leaderboardScreen" class="screen">
            <h1>Classement</h1>
            <div id="leaderboardContent" class="leaderboard">
                <!-- Charg√© dynamiquement -->
            </div>

            <button id="nextQuestionBtn" class="btn btn-primary">Question suivante</button>
            <button id="finishGameBtn" class="btn btn-secondary" style="display:none;">Terminer la partie</button>
            <button id="viewHistoryBtn" class="btn btn-secondary">üìã Voir l'historique</button>
            <button id="endGameBtnLeaderboard" class="btn btn-danger" style="margin-top: 10px;">‚èπÔ∏è Terminer la partie</button>
        </div>

        <!-- √âCRAN 5 : Fin de partie -->
        <div id="finishedScreen" class="screen">
            <h1>üèÜ Partie termin√©e !</h1>
            <div id="finalLeaderboard" class="leaderboard">
                <!-- Charg√© dynamiquement -->
            </div>

            <div class="final-actions">
                <button onclick="location.reload()" class="btn btn-primary">Nouvelle partie</button>
                <button onclick="location.href='/'" class="btn btn-secondary">Retour √† l'accueil</button>
            </div>
        </div>

        <!-- √âCRAN 6 : Historique des questions -->
        <div id="historyScreen" class="screen">
            <h1>üìã Historique des questions</h1>

            <div class="history-header">
                <button id="backFromHistory" class="btn btn-secondary">‚Üê Retour</button>
            </div>

            <div id="historyList" class="history-list">
                <!-- Liste des questions charg√©e dynamiquement -->
            </div>

            <!-- Modal pour les d√©tails d'une question -->
            <div id="questionDetailsModal" class="modal" style="display:none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modalQuestionTitle">Question</h2>
                        <button id="closeModal" class="btn-close">√ó</button>
                    </div>
                    <div class="modal-body">
                        <div id="modalQuestionText" class="question-detail"></div>
                        <div id="modalResponsesList" class="responses-list">
                            <!-- R√©ponses charg√©es dynamiquement -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal pour reprendre une partie -->
        <div id="restoreGameModal" class="modal" style="display:none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Reprendre une partie</h2>
                    <button id="closeRestoreModal" class="btn-close">√ó</button>
                </div>
                <div class="modal-body">
                    <p id="restoreGameMessage">Chargement des parties actives...</p>
                    <div id="activeGamesList" class="active-games-list">
                        <!-- Liste des parties actives charg√©e dynamiquement -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="js/host.js"></script>
</body>
</html>
